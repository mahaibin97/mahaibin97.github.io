静态路由 & RIP
====

2017-10-22

## 1.路由表---网络地图

```
Router#show ip route
查看路由表
```

### 2.获取路由条目的方式

##### 2.1静态路由

管理员一条一条的往路由表中添加条目，一般用于小型网络；

**优势**：安全性高、稳定性好；
**缺点**：不能灵活变通，需要耗费大量的人力去维护；
（运营商拉专线就是通过静态方法）

###### 1）
Router#ip route 目的地网段 子网掩码 下一跳地址（主机地址）/出接口
```
Example：ip route 192.168.2.0 255.255.255.0 192.168.1.2
```

##### !!!静态配置的注意点：
数据通信的有来有回
【实验见：静态路由实验】

###### 2）浮动静态路由的配置
通过更改管理距离来实现，其中一条路断了，还有一条备份的路由可走。
【实验见：浮动静态路由】

###### 3）
缺省路由（默认路由，囊括了所有的地址网段）
一般用在公司出口路由器上。
```
ip route 0.0.0.0 0.0.0.0 出接口/下一跳
```

### 2.2动态路由
动态路由选择协议进行。

###### 1）AS自治系统：处于同一管理机构之下，所有设备组成一个自治系统。
逻辑上划分区域
例，南京市是一个AS
自治系统间互相通信 AS1------AS2

###### 2）IGP & EGP（按照工作范围来分）
IGP  内部网关路由选择协议
运行于自治系统内部的路由选择协议
IGRP、RIP、OSPF、EIGRP

EGP  边界网关路由选择协议
运行于两个自治系统之间的路由选择协议
BGP

###### 3）距离矢量 & 高级距离矢量 & 链路状态 & 路径矢量协议（按照工作类型分）
距离矢量	RIP
高级距离矢量  EIGRP
链路状态	OSPF　IS-IS
路径矢量协议	BGP


###### 4）距离矢量路由选择协议
10.1.1.1.0------R1-----10.2.2.0-----R2---10.3.3.0-----R3------10.4.4.40
R1:10.1.1.0  0跳
10.3.3.0  1跳
10.4.4.0  2跳
RIP管理距离120	
metric值：以跳数来计算，最大跳数为16（当跳数为16时，表示该路由无效）
更新时间：每30 s发一次路由更新

##### !!!注意：
距离矢量存在的一个问题：路由环路。（上述中一旦10.4.4.0断了，就会发生路由环路）
缺点：通信中断、消耗系统资源

##### 解决方案：
【1】水平分割
从一个接口接收到的路由条目，不会再从该接口向外去发；
【2】路由毒化和毒性反转
断掉的网络的metric值被改为16，同时立刻向外发送路由更新。 
【3】hold-down倒计时
240s，断掉之后，启动倒计时，如果240秒之后，网络还未恢复，该条目就被删除。

### RIP的基本配置
Router（config）#router rip
Network [本地网段]

RIP 有3个版本，V1（默认）/V2/ng（IPv6）。
更改RIP版本：
```
Router rip
Version 2 //组播更新，发送更新时携带了子网掩码
```

### 路由表的选取原则

##### 1.精确（最长）匹配原则
172.16.0.0
172.16.1.0
主机位：172.16.1.2 匹配第二个网络
##### 2.管理距离越小越好
##### 3.Metric值越小越好（metric值相同时，达到负载均衡[最多只支持4个负载均衡]）

### RIP认证

##### 1.只在V2中使用；
##### 2.在接口下设定；
##### 3.设定步骤
###### 3.1)创建钥匙串
```
Router（config）#key chain <name>
```

###### 3.2)设定key-id
```
Key <number>
```

###### 3.3)设定密码
```
Key-string <password>
```

###### 3.4)进入接口，设定加密方式（明文/密文，选其一[传递时会不会变成乱码]）
```
Interface <接口> ip rip authentication mode text/md5(明文/密文)
```

###### 3.5）引用钥匙串
```
Ip rip authentication key-chain <name>
```

### ！！结论：
RIP的认证，影响的是接受路由更新。